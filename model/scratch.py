import glob
import os

import cv2
import numpy as np
import tensorflow as tf
from keras.preprocessing.image import load_img, img_to_array
from tensorflow import keras
from tensorflow.keras import layers

os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'

after = cv2.imread('../images/Sample/after/face.gif')
after_rgb = cv2.cvtColor(after, cv2.COLOR_RGB2BGR)
after_rgb_sh = after_rgb.shape  # (262, 350, 3)

train_dir = 'train'
# validation_dir = 'validation'
file_type = 'gif'

train_list_path = glob.glob('../images/' + train_dir + '/*.' + file_type)
# validation_list_path = glob.glob('../images/' + train_dir + '/*.' + file_type)

train_list = []
# validation_list = []
train_shape = after_rgb_sh
# validation_shape = (256, 256, 3)

for img in train_list_path:
    temp_img = load_img(img, target_size=train_shape)
    temp_img_array = img_to_array(temp_img) / 255
    train_list.append(temp_img_array)

# for img in validation_list_path:
#     temp_img = load_img(img, target_size=validation_shape)
#     temp_img_array = img_to_array(temp_img) / 255
#     validation_list.append(temp_img_array)

x_train = np.array(train_list)
# x_validation = np.array(validation_list)

# [[[[0.5529412  0.57254905 0.53333336]
#    [0.49019608 0.50980395 0.48235294]
#    [0.4745098  0.48235294 0.45490196]
#    ...
#    [0.77254903 0.78039217 0.7294118 ]
#    [0.77254903 0.78039217 0.7294118 ]
#    [0.77254903 0.78039217 0.7294118 ]]
#
#   [[0.61960787 0.6313726  0.54509807]
#    [0.5529412  0.57254905 0.53333336]
#    [0.5372549  0.54509807 0.5176471 ]
#    ...
#    [0.85490197 0.88235295 0.80784315]
#    [0.85490197 0.88235295 0.80784315]
#    [0.85490197 0.88235295 0.80784315]]
#
#   [[0.68235296 0.69803923 0.6509804 ]
#    [0.68235296 0.69803923 0.6509804 ]
#    [0.6784314  0.7294118  0.6901961 ]
#    ...
#    [0.8980392  0.8980392  0.85882354]
#    [0.9254902  0.92156863 0.8980392 ]
#    [0.8980392  0.9098039  0.89411765]]
#
#   ...
#
#   [[0.4745098  0.48235294 0.45490196]
#    [0.2901961  0.2901961  0.27058825]
#    [0.23921569 0.24705882 0.25490198]
#    ...
#    [0.14901961 0.14901961 0.15686275]
#    [0.13725491 0.14117648 0.13333334]
#    [0.14901961 0.14901961 0.15686275]]
#
#   [[0.49411765 0.5137255  0.5137255 ]
#    [0.2901961  0.2901961  0.27058825]
#    [0.21960784 0.22352941 0.20392157]
#    ...
#    [0.14901961 0.14901961 0.15686275]
#    [0.14509805 0.16078432 0.14509805]
#    [0.13725491 0.14117648 0.13333334]]
#
#   [[0.5411765  0.52156866 0.46666667]
#    [0.3529412  0.3529412  0.32941177]
#    [0.27058825 0.23529412 0.2       ]
#    ...
#    [0.16862746 0.1764706  0.16470589]
#    [0.16862746 0.1764706  0.16470589]
#    [0.16862746 0.1764706  0.16470589]]]
#
#
#  [[[0.5411765  0.5411765  0.52156866]
#    [0.40784314 0.39607844 0.34509805]
#    [0.42745098 0.44313726 0.4117647 ]
#    ...
#    [0.49019608 0.50980395 0.43137255]
#    [0.52156866 0.49019608 0.45490196]
#    [0.5529412  0.5686275  0.5294118 ]]
#
#   [[0.53333336 0.52156866 0.47058824]
#    [0.49411765 0.5058824  0.46666667]
#    [0.6745098  0.69411767 0.6666667 ]
#    ...
#    [0.47058824 0.45882353 0.40784314]
#    [0.47058824 0.45882353 0.40784314]
#    [0.53333336 0.52156866 0.47058824]]
#
#   [[0.40784314 0.39607844 0.34509805]
#    [0.42745098 0.44313726 0.4117647 ]
#    [0.72156864 0.70980394 0.6666667 ]
#    ...
#    [0.47058824 0.45882353 0.40784314]
#    [0.49019608 0.50980395 0.43137255]
#    [0.49411765 0.5058824  0.46666667]]
#
#   ...
#
#   [[0.5529412  0.5686275  0.46666667]
#    [0.654902   0.5882353  0.53333336]
#    [0.654902   0.64705884 0.6039216 ]
#    ...
#    [0.23529412 0.25882354 0.22352941]
#    [0.23529412 0.26666668 0.27058825]
#    [0.21960784 0.22745098 0.2       ]]
#
#   [[0.5294118  0.5137255  0.41960785]
#    [0.5294118  0.5137255  0.41960785]
#    [0.53333336 0.52156866 0.47058824]
#    ...
#    [0.28235295 0.2901961  0.27058825]
#    [0.29411766 0.32941177 0.34901962]
#    [0.3019608  0.31764707 0.2784314 ]]
#
#   [[0.4745098  0.4509804  0.35686275]
#    [0.47058824 0.45882353 0.40784314]
#    [0.5294118  0.5137255  0.41960785]
#    ...
#    [0.6117647  0.64705884 0.64705884]
#    [0.6862745  0.68235296 0.69803923]
#    [0.70980394 0.7254902  0.7607843 ]]]
#
#
#  [[[0.78039217 0.78039217 0.72156864]
#    [0.9137255  0.8980392  0.84313726]
#    [0.92156863 0.94509804 0.8627451 ]
#    ...
#    [0.8392157  0.84705883 0.78431374]
#    [0.8392157  0.84705883 0.78431374]
#    [0.8392157  0.84705883 0.78431374]]
#
#   [[0.8392157  0.84705883 0.78431374]
#    [0.92156863 0.94509804 0.8627451 ]
#    [0.93333334 0.94509804 0.91764706]
#    ...
#    [0.827451   0.84313726 0.7411765 ]
#    [0.8        0.827451   0.76862746]
#    [0.8392157  0.84705883 0.78431374]]
#
#   [[0.8392157  0.84705883 0.78431374]
#    [0.92156863 0.94509804 0.8627451 ]
#    [0.9490196  0.9490196  0.92941177]
#    ...
#    [0.8392157  0.84705883 0.78431374]
#    [0.8509804  0.8784314  0.7490196 ]
#    [0.8392157  0.84705883 0.78431374]]
#
#   ...
#
#   [[0.3529412  0.4        0.33333334]
#    [0.3529412  0.4        0.33333334]
#    [0.3529412  0.4        0.33333334]
#    ...
#    [0.24313726 0.32156864 0.27450982]
#    [0.29803923 0.38039216 0.28627452]
#    [0.29803923 0.38039216 0.28627452]]
#
#   [[0.5411765  0.5882353  0.52156866]
#    [0.5411765  0.5882353  0.52156866]
#    [0.59607846 0.5921569  0.53333336]
#    ...
#    [0.47843137 0.5254902  0.45490196]
#    [0.47843137 0.5254902  0.45490196]
#    [0.47843137 0.5254902  0.45490196]]
#
#   [[0.8392157  0.84705883 0.78431374]
#    [0.87058824 0.8901961  0.84313726]
#    [0.87058824 0.8901961  0.84313726]
#    ...
#    [0.49019608 0.5764706  0.46666667]
#    [0.5372549  0.5803922  0.4862745 ]
#    [0.5372549  0.5803922  0.4862745 ]]]
#
#
#  [[[0.8117647  0.8784314  0.80784315]
#    [0.85490197 0.8862745  0.8039216 ]
#    [0.8627451  0.8901961  0.83137256]
#    ...
#    [0.7254902  0.7764706  0.7137255 ]
#    [0.7254902  0.7764706  0.7137255 ]
#    [0.7254902  0.7764706  0.7137255 ]]
#
#   [[0.8980392  0.8980392  0.85882354]
#    [0.96862745 0.9647059  0.9137255 ]
#    [0.93333334 0.94509804 0.92941177]
#    ...
#    [0.8627451  0.8901961  0.83137256]
#    [0.9098039  0.94509804 0.8666667 ]
#    [0.8117647  0.8784314  0.80784315]]
#
#   [[0.91764706 0.9490196  0.8901961 ]
#    [0.98039216 0.9843137  0.9607843 ]
#    [0.9882353  0.9882353  0.99215686]
#    ...
#    [0.9490196  0.9490196  0.9529412 ]
#    [0.96862745 0.9647059  0.9137255 ]
#    [0.8627451  0.8901961  0.83137256]]
#
#   ...
#
#   [[0.7372549  0.70980394 0.6627451 ]
#    [0.7372549  0.70980394 0.6627451 ]
#    [0.79607844 0.7607843  0.6784314 ]
#    ...
#    [0.7254902  0.7607843  0.6745098 ]
#    [0.7372549  0.70980394 0.6627451 ]
#    [0.6784314  0.69411767 0.61960787]]
#
#   [[0.79607844 0.7607843  0.6784314 ]
#    [0.79607844 0.7607843  0.6784314 ]
#    [0.83137256 0.8        0.7372549 ]
#    ...
#    [0.7254902  0.7607843  0.6745098 ]
#    [0.6784314  0.69411767 0.61960787]
#    [0.6745098  0.7019608  0.6392157 ]]
#
#   [[0.96862745 0.9529412  0.8666667 ]
#    [0.96862745 0.9647059  0.9137255 ]
#    [0.96862745 0.9647059  0.9137255 ]
#    ...
#    [0.65882355 0.6509804  0.6       ]
#    [0.6117647  0.60784316 0.57254905]
#    [0.54901963 0.54509807 0.5137255 ]]]
#
#
#  [[[0.59607846 0.5882353  0.5921569 ]
#    [0.6        0.64705884 0.6392157 ]
#    [0.7294118  0.72156864 0.7137255 ]
#    ...
#    [0.9490196  0.9529412  0.9607843 ]
#    [0.9490196  0.9529412  0.9607843 ]
#    [0.93333334 0.94509804 0.9529412 ]]
#
#   [[0.7294118  0.72156864 0.7137255 ]
#    [0.7137255  0.75686276 0.7490196 ]
#    [0.8509804  0.84313726 0.8352941 ]
#    ...
#    [0.9490196  0.9529412  0.9607843 ]
#    [0.9490196  0.9529412  0.9607843 ]
#    [0.94509804 0.93333334 0.9529412 ]]
#
#   [[0.7294118  0.72156864 0.7137255 ]
#    [0.7294118  0.7372549  0.7607843 ]
#    [0.8509804  0.84313726 0.8352941 ]
#    ...
#    [0.9490196  0.9529412  0.9607843 ]
#    [0.94509804 0.93333334 0.9529412 ]
#    [0.92941177 0.93333334 0.94509804]]
#
#   ...
#
#   [[0.6666667  0.69411767 0.6862745 ]
#    [0.65882355 0.6392157  0.60784316]
#    [0.5529412  0.54901963 0.5686275 ]
#    ...
#    [0.15294118 0.19607843 0.1764706 ]
#    [0.23137255 0.18431373 0.19215687]
#    [0.23529412 0.19215687 0.16862746]]
#
#   [[0.7294118  0.72156864 0.7137255 ]
#    [0.7294118  0.72156864 0.7137255 ]
#    [0.65882355 0.6392157  0.60784316]
#    ...
#    [0.22745098 0.20784314 0.2       ]
#    [0.22745098 0.20784314 0.2       ]
#    [0.22745098 0.20784314 0.2       ]]
#
#   [[0.46666667 0.4627451  0.4627451 ]
#    [0.47843137 0.5137255  0.48235294]
#    [0.5411765  0.5254902  0.5176471 ]
#    ...
#    [0.49411765 0.5686275  0.5568628 ]
#    [0.49411765 0.5686275  0.5568628 ]
#    [0.49411765 0.5686275  0.5568628 ]]]
#
#
#  [[[0.9490196  0.88235295 0.87058824]
#    [0.94509804 0.9529412  0.92941177]
#    [0.9764706  0.9764706  0.9843137 ]
#    ...
#    [0.83137256 0.84705883 0.7921569 ]
#    [0.83137256 0.84705883 0.7921569 ]
#    [0.79607844 0.827451   0.78431374]]
#
#   [[0.9019608  0.8980392  0.8627451 ]
#    [0.94509804 0.9529412  0.92941177]
#    [0.94509804 0.9529412  0.92941177]
#    ...
#    [0.83137256 0.84705883 0.7921569 ]
#    [0.83137256 0.84705883 0.7921569 ]
#    [0.83137256 0.84705883 0.7921569 ]]
#
#   [[0.9019608  0.8980392  0.8627451 ]
#    [0.94509804 0.9529412  0.92941177]
#    [0.94509804 0.9529412  0.92941177]
#    ...
#    [0.83137256 0.84705883 0.7921569 ]
#    [0.83137256 0.84705883 0.7921569 ]
#    [0.83137256 0.84705883 0.7921569 ]]
#
#   ...
#
#   [[0.34117648 0.33333334 0.2901961 ]
#    [0.29411766 0.3254902  0.28235295]
#    [0.34509805 0.3882353  0.29411766]
#    ...
#    [0.21176471 0.23137255 0.21960784]
#    [0.23137255 0.2627451  0.21960784]
#    [0.23137255 0.2627451  0.21960784]]
#
#   [[0.3529412  0.39215687 0.34509805]
#    [0.3529412  0.39215687 0.34509805]
#    [0.3529412  0.39215687 0.34509805]
#    ...
#    [0.21176471 0.25882354 0.18039216]
#    [0.21176471 0.23137255 0.21960784]
#    [0.20392157 0.22745098 0.2       ]]
#
#   [[0.6666667  0.7058824  0.6666667 ]
#    [0.6666667  0.7058824  0.6666667 ]
#    [0.6666667  0.7058824  0.6666667 ]
#    ...
#    [0.21176471 0.23137255 0.21960784]
#    [0.23137255 0.2627451  0.21960784]
#    [0.21176471 0.23137255 0.21960784]]]][[[[0.5529412  0.57254905 0.53333336]
#    [0.49019608 0.50980395 0.48235294]
#    [0.4745098  0.48235294 0.45490196]
#    ...
#    [0.77254903 0.78039217 0.7294118 ]
#    [0.77254903 0.78039217 0.7294118 ]
#    [0.77254903 0.78039217 0.7294118 ]]
#
#   [[0.61960787 0.6313726  0.54509807]
#    [0.5529412  0.57254905 0.53333336]
#    [0.5372549  0.54509807 0.5176471 ]
#    ...
#    [0.85490197 0.88235295 0.80784315]
#    [0.85490197 0.88235295 0.80784315]
#    [0.85490197 0.88235295 0.80784315]]
#
#   [[0.68235296 0.69803923 0.6509804 ]
#    [0.68235296 0.69803923 0.6509804 ]
#    [0.6784314  0.7294118  0.6901961 ]
#    ...
#    [0.8980392  0.8980392  0.85882354]
#    [0.9254902  0.92156863 0.8980392 ]
#    [0.8980392  0.9098039  0.89411765]]
#
#   ...
#
#   [[0.4745098  0.48235294 0.45490196]
#    [0.2901961  0.2901961  0.27058825]
#    [0.23921569 0.24705882 0.25490198]
#    ...
#    [0.14901961 0.14901961 0.15686275]
#    [0.13725491 0.14117648 0.13333334]
#    [0.14901961 0.14901961 0.15686275]]
#
#   [[0.49411765 0.5137255  0.5137255 ]
#    [0.2901961  0.2901961  0.27058825]
#    [0.21960784 0.22352941 0.20392157]
#    ...
#    [0.14901961 0.14901961 0.15686275]
#    [0.14509805 0.16078432 0.14509805]
#    [0.13725491 0.14117648 0.13333334]]
#
#   [[0.5411765  0.52156866 0.46666667]
#    [0.3529412  0.3529412  0.32941177]
#    [0.27058825 0.23529412 0.2       ]
#    ...
#    [0.16862746 0.1764706  0.16470589]
#    [0.16862746 0.1764706  0.16470589]
#    [0.16862746 0.1764706  0.16470589]]]
#
#
#  [[[0.5411765  0.5411765  0.52156866]
#    [0.40784314 0.39607844 0.34509805]
#    [0.42745098 0.44313726 0.4117647 ]
#    ...
#    [0.49019608 0.50980395 0.43137255]
#    [0.52156866 0.49019608 0.45490196]
#    [0.5529412  0.5686275  0.5294118 ]]
#
#   [[0.53333336 0.52156866 0.47058824]
#    [0.49411765 0.5058824  0.46666667]
#    [0.6745098  0.69411767 0.6666667 ]
#    ...
#    [0.47058824 0.45882353 0.40784314]
#    [0.47058824 0.45882353 0.40784314]
#    [0.53333336 0.52156866 0.47058824]]
#
#   [[0.40784314 0.39607844 0.34509805]
#    [0.42745098 0.44313726 0.4117647 ]
#    [0.72156864 0.70980394 0.6666667 ]
#    ...
#    [0.47058824 0.45882353 0.40784314]
#    [0.49019608 0.50980395 0.43137255]
#    [0.49411765 0.5058824  0.46666667]]
#
#   ...
#
#   [[0.5529412  0.5686275  0.46666667]
#    [0.654902   0.5882353  0.53333336]
#    [0.654902   0.64705884 0.6039216 ]
#    ...
#    [0.23529412 0.25882354 0.22352941]
#    [0.23529412 0.26666668 0.27058825]
#    [0.21960784 0.22745098 0.2       ]]
#
#   [[0.5294118  0.5137255  0.41960785]
#    [0.5294118  0.5137255  0.41960785]
#    [0.53333336 0.52156866 0.47058824]
#    ...
#    [0.28235295 0.2901961  0.27058825]
#    [0.29411766 0.32941177 0.34901962]
#    [0.3019608  0.31764707 0.2784314 ]]
#
#   [[0.4745098  0.4509804  0.35686275]
#    [0.47058824 0.45882353 0.40784314]
#    [0.5294118  0.5137255  0.41960785]
#    ...
#    [0.6117647  0.64705884 0.64705884]
#    [0.6862745  0.68235296 0.69803923]
#    [0.70980394 0.7254902  0.7607843 ]]]
#
#
#  [[[0.78039217 0.78039217 0.72156864]
#    [0.9137255  0.8980392  0.84313726]
#    [0.92156863 0.94509804 0.8627451 ]
#    ...
#    [0.8392157  0.84705883 0.78431374]
#    [0.8392157  0.84705883 0.78431374]
#    [0.8392157  0.84705883 0.78431374]]
#
#   [[0.8392157  0.84705883 0.78431374]
#    [0.92156863 0.94509804 0.8627451 ]
#    [0.93333334 0.94509804 0.91764706]
#    ...
#    [0.827451   0.84313726 0.7411765 ]
#    [0.8        0.827451   0.76862746]
#    [0.8392157  0.84705883 0.78431374]]
#
#   [[0.8392157  0.84705883 0.78431374]
#    [0.92156863 0.94509804 0.8627451 ]
#    [0.9490196  0.9490196  0.92941177]
#    ...
#    [0.8392157  0.84705883 0.78431374]
#    [0.8509804  0.8784314  0.7490196 ]
#    [0.8392157  0.84705883 0.78431374]]
#
#   ...
#
#   [[0.3529412  0.4        0.33333334]
#    [0.3529412  0.4        0.33333334]
#    [0.3529412  0.4        0.33333334]
#    ...
#    [0.24313726 0.32156864 0.27450982]
#    [0.29803923 0.38039216 0.28627452]
#    [0.29803923 0.38039216 0.28627452]]
#
#   [[0.5411765  0.5882353  0.52156866]
#    [0.5411765  0.5882353  0.52156866]
#    [0.59607846 0.5921569  0.53333336]
#    ...
#    [0.47843137 0.5254902  0.45490196]
#    [0.47843137 0.5254902  0.45490196]
#    [0.47843137 0.5254902  0.45490196]]
#
#   [[0.8392157  0.84705883 0.78431374]
#    [0.87058824 0.8901961  0.84313726]
#    [0.87058824 0.8901961  0.84313726]
#    ...
#    [0.49019608 0.5764706  0.46666667]
#    [0.5372549  0.5803922  0.4862745 ]
#    [0.5372549  0.5803922  0.4862745 ]]]
#
#
#  [[[0.8117647  0.8784314  0.80784315]
#    [0.85490197 0.8862745  0.8039216 ]
#    [0.8627451  0.8901961  0.83137256]
#    ...
#    [0.7254902  0.7764706  0.7137255 ]
#    [0.7254902  0.7764706  0.7137255 ]
#    [0.7254902  0.7764706  0.7137255 ]]
#
#   [[0.8980392  0.8980392  0.85882354]
#    [0.96862745 0.9647059  0.9137255 ]
#    [0.93333334 0.94509804 0.92941177]
#    ...
#    [0.8627451  0.8901961  0.83137256]
#    [0.9098039  0.94509804 0.8666667 ]
#    [0.8117647  0.8784314  0.80784315]]
#
#   [[0.91764706 0.9490196  0.8901961 ]
#    [0.98039216 0.9843137  0.9607843 ]
#    [0.9882353  0.9882353  0.99215686]
#    ...
#    [0.9490196  0.9490196  0.9529412 ]
#    [0.96862745 0.9647059  0.9137255 ]
#    [0.8627451  0.8901961  0.83137256]]
#
#   ...
#
#   [[0.7372549  0.70980394 0.6627451 ]
#    [0.7372549  0.70980394 0.6627451 ]
#    [0.79607844 0.7607843  0.6784314 ]
#    ...
#    [0.7254902  0.7607843  0.6745098 ]
#    [0.7372549  0.70980394 0.6627451 ]
#    [0.6784314  0.69411767 0.61960787]]
#
#   [[0.79607844 0.7607843  0.6784314 ]
#    [0.79607844 0.7607843  0.6784314 ]
#    [0.83137256 0.8        0.7372549 ]
#    ...
#    [0.7254902  0.7607843  0.6745098 ]
#    [0.6784314  0.69411767 0.61960787]
#    [0.6745098  0.7019608  0.6392157 ]]
#
#   [[0.96862745 0.9529412  0.8666667 ]
#    [0.96862745 0.9647059  0.9137255 ]
#    [0.96862745 0.9647059  0.9137255 ]
#    ...
#    [0.65882355 0.6509804  0.6       ]
#    [0.6117647  0.60784316 0.57254905]
#    [0.54901963 0.54509807 0.5137255 ]]]
#
#
#  [[[0.59607846 0.5882353  0.5921569 ]
#    [0.6        0.64705884 0.6392157 ]
#    [0.7294118  0.72156864 0.7137255 ]
#    ...
#    [0.9490196  0.9529412  0.9607843 ]
#    [0.9490196  0.9529412  0.9607843 ]
#    [0.93333334 0.94509804 0.9529412 ]]
#
#   [[0.7294118  0.72156864 0.7137255 ]
#    [0.7137255  0.75686276 0.7490196 ]
#    [0.8509804  0.84313726 0.8352941 ]
#    ...
#    [0.9490196  0.9529412  0.9607843 ]
#    [0.9490196  0.9529412  0.9607843 ]
#    [0.94509804 0.93333334 0.9529412 ]]
#
#   [[0.7294118  0.72156864 0.7137255 ]
#    [0.7294118  0.7372549  0.7607843 ]
#    [0.8509804  0.84313726 0.8352941 ]
#    ...
#    [0.9490196  0.9529412  0.9607843 ]
#    [0.94509804 0.93333334 0.9529412 ]
#    [0.92941177 0.93333334 0.94509804]]
#
#   ...
#
#   [[0.6666667  0.69411767 0.6862745 ]
#    [0.65882355 0.6392157  0.60784316]
#    [0.5529412  0.54901963 0.5686275 ]
#    ...
#    [0.15294118 0.19607843 0.1764706 ]
#    [0.23137255 0.18431373 0.19215687]
#    [0.23529412 0.19215687 0.16862746]]
#
#   [[0.7294118  0.72156864 0.7137255 ]
#    [0.7294118  0.72156864 0.7137255 ]
#    [0.65882355 0.6392157  0.60784316]
#    ...
#    [0.22745098 0.20784314 0.2       ]
#    [0.22745098 0.20784314 0.2       ]
#    [0.22745098 0.20784314 0.2       ]]
#
#   [[0.46666667 0.4627451  0.4627451 ]
#    [0.47843137 0.5137255  0.48235294]
#    [0.5411765  0.5254902  0.5176471 ]
#    ...
#    [0.49411765 0.5686275  0.5568628 ]
#    [0.49411765 0.5686275  0.5568628 ]
#    [0.49411765 0.5686275  0.5568628 ]]]
#
#
#  [[[0.9490196  0.88235295 0.87058824]
#    [0.94509804 0.9529412  0.92941177]
#    [0.9764706  0.9764706  0.9843137 ]
#    ...
#    [0.83137256 0.84705883 0.7921569 ]
#    [0.83137256 0.84705883 0.7921569 ]
#    [0.79607844 0.827451   0.78431374]]
#
#   [[0.9019608  0.8980392  0.8627451 ]
#    [0.94509804 0.9529412  0.92941177]
#    [0.94509804 0.9529412  0.92941177]
#    ...
#    [0.83137256 0.84705883 0.7921569 ]
#    [0.83137256 0.84705883 0.7921569 ]
#    [0.83137256 0.84705883 0.7921569 ]]
#
#   [[0.9019608  0.8980392  0.8627451 ]
#    [0.94509804 0.9529412  0.92941177]
#    [0.94509804 0.9529412  0.92941177]
#    ...
#    [0.83137256 0.84705883 0.7921569 ]
#    [0.83137256 0.84705883 0.7921569 ]
#    [0.83137256 0.84705883 0.7921569 ]]
#
#   ...
#
#   [[0.34117648 0.33333334 0.2901961 ]
#    [0.29411766 0.3254902  0.28235295]
#    [0.34509805 0.3882353  0.29411766]
#    ...
#    [0.21176471 0.23137255 0.21960784]
#    [0.23137255 0.2627451  0.21960784]
#    [0.23137255 0.2627451  0.21960784]]
#
#   [[0.3529412  0.39215687 0.34509805]
#    [0.3529412  0.39215687 0.34509805]
#    [0.3529412  0.39215687 0.34509805]
#    ...
#    [0.21176471 0.25882354 0.18039216]
#    [0.21176471 0.23137255 0.21960784]
#    [0.20392157 0.22745098 0.2       ]]
#
#   [[0.6666667  0.7058824  0.6666667 ]
#    [0.6666667  0.7058824  0.6666667 ]
#    [0.6666667  0.7058824  0.6666667 ]
#    ...
#    [0.21176471 0.23137255 0.21960784]
#    [0.23137255 0.2627451  0.21960784]
#    [0.21176471 0.23137255 0.21960784]]]]

# print(x_train.shape)
# (6, 262, 350, 3)

# print(x_validation.shape)
# (6, 256, 256, 3)


model = keras.Sequential(
    [
        keras.Input(shape=after_rgb_sh),
        layers.Conv2D(32, 5, name='Layer_0', strides=2, activation="relu", trainable=False),
        layers.Conv2D(32, 3, name='Layer_1', activation="relu", trainable=False),
        layers.Conv2D(32, 3, name='Layer_2', activation="relu", trainable=False),
    ]
)

base_learning_rate = 0.0001
model.compile(optimizer=tf.keras.optimizers.Adam(learning_rate=base_learning_rate),
              loss=tf.keras.losses.BinaryCrossentropy(from_logits=True),
              metrics=[tf.keras.metrics.BinaryAccuracy(threshold=0, name='accuracy')])

feature_extractor = keras.Model(
    inputs=model.inputs,
    outputs=model.get_layer(name="Layer_1").output,
)
# Call feature extractor on test input.
x = tf.ones((1, 262, 350, 3))
features = feature_extractor(x)

global_average_layer = tf.keras.layers.GlobalAveragePooling2D()
feature_batch_average = global_average_layer(features)

print(feature_batch_average.shape[1])
# 32
